flow:
  id: 'parent-greetings'
  description: 'hierarchy of flows'
  ttl: 10s

first.task: 'no.op'

tasks:
  - input: []
    process: 'no.op'
    output: []
    description: 'Just a dummy step'
    execution: sequential
    next:
    - 'another.flow'

  #
  # A subflow is treated in the same fashion as a task so you can map argument and header
  #
  # Before version 4.3.28, subflow's input data mapping requires the RHS uses the "body." namespace
  # to map the LHS' value as input argument. This behavior is inconsistent with the input data mapping
  # for regular task.
  #
  # This bug is resolved in version 4.3.28. For backward compatibility, this redundant "body." namespace
  # is automatically adjusted. A warning message will be logged when the system detects the outdated syntax.
  #
  - name: 'another.flow'
    input:
      - 'input.path_parameter.user -> user'
      - 'text(hello world) -> body.greeting'
      - 'long(12345) -> long_number'
      - 'float(12.345) -> float_number'
      - 'double(12.345) -> double_number'
      - 'boolean(true) -> boolean_value'
      - 'input.header -> header'
      - 'input.path_parameter.user -> header.user'
      - 'text(ok) -> header.demo'
    process: 'flow://daughter-greetings'
    output:
      - 'text(application/json) -> output.header.content-type'
      - 'result -> output.body'
      - 'model.root.name -> output.body.name'
      - 'model.root.hello -> output.body.hello'
      - 'header -> output.header'
      - 'status -> output.status'
    description: 'Hello World'
    execution: end
    exception: 'v1.hello.exception'

  - input:
      - 'error.code -> status'
      - 'error.message -> message'
      - 'error.stack -> stack'
    process: 'v1.hello.exception'
    output:
      - 'result.status -> output.status'
      - 'result -> output.body'
    description: 'Just a demo exception handler'
    execution: end
